(function(n){"use strict";function i(n){return moment(n).utc().format("ddd, DD MMM YYYY HH:mm:ss z")}var t={},r=_.throttle(function(){return _.chain(document.cookie.split("; ")).reduce(function(n,t){var i=t.split("=");return n[i[0]]=i[1],n},{}).value()},500);t.KeyExists=function(n){return _.has(r(),n)};t.Delete=function(n){t.Set(n,null,i(moment().add(-1,"days")))};t.Get=function(n){if(!t.KeyExists(n))throw"Key not set: "+n;var i=r();return i[n]};t.Set=function(n,t,r,u){var f=[n+"="+t];return(_.isNull(t)||_.isUndefined(t)||_.isNaN(t))&&(r=i(moment().add(-1,"days"))),r&&f.push("expires="+i(r)),u&&f.push("path="+u),document.cookie=f.join("; ")};n=n||{};n.Cookies=t;window.App=n})(window.App),function(n){"use strict";function r(){var n;try{n=JSON.parse(localStorage[i])}catch(t){n=null}return!n||!_.isObject(n)||_.isArray(n)?{}:n}var t={},i="cookies",u=_.throttle(function(){var n=r(),t=0;return t=_.chain(n).filter(function(n){return!moment().isBefore(n.Expires)}).each(function(i,r){t++;delete n[r]}),t&&(localStorage[i]=JSON.stringify(n)),_.reduce(n,function(n,t,i){return n[i]=t.Value,n},{})},500);t.KeyExists=function(n){return _.has(u(),n)};t.Delete=function(n){if(t.KeyExists(n)){var u=r();delete u[n];localStorage[i]=JSON.stringify(u)}};t.Get=function(n){if(!t.KeyExists(n))throw"Key not set: "+n;var i=u();return i[n]};t.Set=function(n,t,u,f){var e=r();return e[n]={Value:t,Expires:u,Path:f},localStorage[i]=JSON.stringify(e),!0};n=n||{};n.LocalStorage=t;window.App=n}(window.App),function(n){"use strict";var t=n.App||{};t.CurrentAssignment=null;t.Store={};$(function(){t.Store=t.SupportsLocalStorage()?t.LocalStorage:t.Cookies;var n=0,i="where the answers at",r=_.debounce(function(){n=0},1e3);$(document).on("keydown",function(t){r();var u=String.fromCharCode(t.which).toLowerCase();(u===i.substr(n,1)?n++:n=0,n<i.length)||(n=0,$(".correct").closest(".list-group-item").toggleClass("correct-show"))}).on("click",function(){var n=_.map($("input:checked"),function(n){var t=$(n);return t.attr("id")});t.Store.Set(t.CurrentAssignment,n,moment().add(30,"days"))})});t.CheckAnswers=function(){var t=_.size($("input.correct")),i=_.size($("input:checked")),n=_.size($("input.correct:checked"));i===t?$(".score").html(n+"/"+t+" &ndash; "+(n/t*100).toFixed(2)+"%<br /><small>Final<\/small>"):$(".score").html("Attempted: "+n+"/"+i+" &ndash; "+(n/i*100||0).toFixed(2)+"%<br /><small>Total: "+n+"/"+t+" &ndash; "+(n/t*100).toFixed(2)+"%<\/small>")};t.GetQueryParams=_.once(function(){for(var i=/(?:[\?&])(.+)=(.+)/g,n,t={};n=i.exec(document.location.search);)t[n[1]]=n[2];return t});t.FromQuery=function(n){return t.GetQueryParams()[n]};t.Load=function(n){return n=_.isString(n)?n:t.FromQuery("load"),t.CurrentAssignment="assignment_"+n,Promise.resolve($.ajax("Assignments/"+n+".md",{contentType:"text/plain"})).then(function(n){var i=marked(n),t=$("#main-body");t.html(i);document.title=$(i).filter("h1").first().text()||"Assignment";t.find(".lang-cs").each(function(n,t){var i=$(t),r=i.closest("pre"),u=i.html(),f;r.html(u).addClass("prettyprint lang-cs");f=_.size(u.trim().split("\n"));f>5&&r.addClass("linenums");i.remove()});t.find(".lang-console").each(function(n,t){var r=$(t),u=r.closest("pre"),i=r.html();i=i.replace(/^(\s*)@(.*)$/gm,'$1<span class="input">$2<\/span>');i=i.replace(/^(\s*)(?:>|&gt;)(.*)$/gm,'$1<span class="typewriter">$2<\/span>');u.html(i).addClass("console");r.remove()});t.find("blockquote").each(function(n,t){var i=$(t),u=i.find("p"),r=$("<ul class='list-group answers'><\/ul>"),f=u.html().split("\n");_.each(f,function(n){var t=$("<li class='list-group-item'><div class='radio'><label><input type='radio' /><\/label><\/div><\/li>");n.indexOf("!")===0&&(t.find("input").addClass("correct"),n=n.substr(1).trim());t.find("label").append(n);r.append(t)});r.insertBefore(i);i.remove()});prettyPrint()}).then(t.WireUpQuestions).then(t.RestoreAnswers).caught(function(){$("#main-body").html("<h1 class='page-header'>Assignment<\/h1><div class='alert alert-info'><strong>Not found<\/strong> No assignment could be found. It was either removed or hasn't been created yet.<\/div>");$(".well").hide()})};t.RestoreAnswers=function(){if(t.Store.KeyExists(t.CurrentAssignment)){var n=t.Store.Get(t.CurrentAssignment);_.each(n,function(n){$("#"+n).attr("checked","checked")});t.CheckAnswers()}};t.SupportsLocalStorage=_.once(function(){var n="test";try{return localStorage.setItem(n,n),localStorage.removeItem(n),!0}catch(t){return!1}});t.WireUpQuestions=function(){$(document).on("click","input[type='radio'], input[type='check']",t.CheckAnswers);$(".answers").each(function(n,t){$(t).find("input[type='radio'], input[type='check']").each(function(t,i){$(i).attr("name","q"+n).attr("id",_.uniqueId("choice"))})})};n.App=t}(window);